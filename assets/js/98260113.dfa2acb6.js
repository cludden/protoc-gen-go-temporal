"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9441],{8439:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>l,metadata:()=>u,toc:()=>p});var r=n(4848),o=n(8453),a=n(1470),i=n(9365);const l={},s="Activities",u={id:"guides/activities",title:"Activities",description:"Implementation",source:"@site/docs/guides/activities.mdx",sourceDirName:"guides",slug:"/guides/activities",permalink:"/protoc-gen-go-temporal/docs/guides/activities",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/guides/activities.mdx",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Workflows",permalink:"/protoc-gen-go-temporal/docs/guides/workflows"},next:{title:"Queries",permalink:"/protoc-gen-go-temporal/docs/guides/queries"}},c={},p=[{value:"Implementation",id:"implementation",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Registration",id:"registration",level:2}];function m(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"activities",children:"Activities"}),"\n",(0,r.jsx)(t.h2,{id:"implementation",children:"Implementation"}),"\n",(0,r.jsxs)(t.p,{children:["Activities are implemented as methods on a Go ",(0,r.jsx)(t.code,{children:"struct"})," that satisfies the generated ",(0,r.jsx)(t.code,{children:"<Service>Activities"})," interface type generated by this plugin"]}),"\n",(0,r.jsxs)(a.A,{children:[(0,r.jsx)(i.A,{value:"implementation-go",label:"Go",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "context"\n\n    examplev1 "path/to/gen/example/v1"\n    "go.temporal.io/sdk/activity"\n)\n\ntype Activities struct {}\n\nfunc (a *Activities) Execute(ctx context.Context, input *examplev1.HelloInput) (*examplev1.HelloOutput, error) {\n    activity.GetLogger(ctx).Info("executing hello activity", "input", input)\n    return &examplev1.HelloOutput{}, nil\n}\n\n// type assertion for illustrative purposes\nvar _ examplev1.ExampleActivities = (*Activities)(nil)\n'})})}),(0,r.jsx)(i.A,{value:"implementation-schema",label:"Schema",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-protobuf",metastring:'title="example.proto"',children:'syntax="proto3";\n\npackage example.v1;\n\nimport "temporal/v1/temporal.proto";\n\nservice Example {\n  // Hello returns a friendly greeting\n  rpc Hello(HelloInput) returns (HelloOutput) {\n    option (temporal.v1.activity) = {\n      start_to_close_timeout: { seconds: 60 }\n    };\n  }\n}\n'})})})]}),"\n",(0,r.jsx)(t.h3,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsx)(t.p,{children:"The signature of an activity method varies based on whether or not the activity definition specifies a non-empty input and/or output message type."}),"\n",(0,r.jsxs)(a.A,{children:[(0,r.jsxs)(i.A,{value:"parameters-both",label:"Input & Output Parameters",children:[(0,r.jsx)(t.p,{children:"Most activities should specify both an input and output message type, even if the type is empty. This to support the addition of fields to either the input or output (or both) in the future without needing to introduce a breaking change."}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-protobuf",metastring:'title="example.proto"',children:'syntax="proto3";\n\npackage example.v1;\n\nimport "temporal/v1/temporal.proto";\n\nservice Example {\n  // Hello returns a friendly greeting\n  rpc Hello(HelloInput) returns (HelloOutput) {\n    option (temporal.v1.activity) = {\n      start_to_close_timeout: { seconds: 60 }\n    };\n  }\n}\n'})}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "context"\n\n    examplev1 "path/to/gen/example/v1"\n)\n\ntype Activities struct {}\n\nfunc (a *Activities) Hello(ctx context.Context, input *examplev1.HelloInput) (*examplev1.HelloOutput, error) {\n    return &examplev1.HelloOutput{}, nil\n}\n'})})]}),(0,r.jsxs)(i.A,{value:"parameters-input",label:"No Output Parameter",children:[(0,r.jsxs)(t.p,{children:["An Activity output can be omitted using the native ",(0,r.jsx)(t.a,{href:"https://protobuf.dev/reference/protobuf/google.protobuf/#empty",children:"google.protobuf.Empty"})," type. This modifies the signature of the Activity method to have a single return value of type ",(0,r.jsx)(t.code,{children:"error"}),". Note that this also requires an additional ",(0,r.jsx)(t.code,{children:"google/protobuf/empty.proto"})," protobuf import statement."]}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-protobuf",metastring:'title="example.proto"',children:'syntax="proto3";\n\npackage example.v1;\n\nimport "google/protobuf/empty.proto";\nimport "temporal/v1/temporal.proto";\n\nservice Example {\n  // Hello returns a friendly greeting\n  rpc Hello(HelloInput) returns (google.protobuf.Empty) {\n    option (temporal.v1.activity) = {\n      start_to_close_timeout: { seconds: 60 }\n    };\n  }\n}\n'})}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "context"\n\n    examplev1 "path/to/gen/example/v1"\n)\n\ntype Activities struct {}\n\nfunc (a *Activities) Hello(ctx context.Context, input *examplev1.HelloInput) error {\n    return nil\n}\n'})})]}),(0,r.jsxs)(i.A,{value:"parameters-output",label:"No Input Parameter",children:[(0,r.jsxs)(t.p,{children:["An Activity input can be omitted using the native ",(0,r.jsx)(t.a,{href:"https://protobuf.dev/reference/protobuf/google.protobuf/#empty",children:"google.protobuf.Empty"})," type. This modifies the signature of the Activity method to have a single input argument of type ",(0,r.jsx)(t.code,{children:"context.Context"}),". Note that this also requires an additional ",(0,r.jsx)(t.code,{children:"google/protobuf/empty.proto"})," protobuf import statement."]}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-protobuf",metastring:'title="example.proto"',children:'syntax="proto3";\n\npackage example.v1;\n\nimport "google/protobuf/empty.proto";\nimport "temporal/v1/temporal.proto";\n\nservice Example {\n  // Hello returns a friendly greeting\n  rpc Hello(google.protobuf.Empty) returns (HelloOutput) {\n    option (temporal.v1.activity) = {\n      start_to_close_timeout: { seconds: 60 }\n    };\n  }\n}\n'})}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "context"\n\n    examplev1 "path/to/gen/example/v1"\n)\n\ntype Activities struct {}\n\nfunc (a *Activities) Hello(ctx context.Context) (*examplev1.HelloOutput, error) {\n    return &examplev1.HelloOutput{}, nil\n}\n'})})]}),(0,r.jsxs)(i.A,{value:"parameters-none",label:"No Parameters",children:[(0,r.jsxs)(t.p,{children:["An Activity can omit both input and output parameters using the native ",(0,r.jsx)(t.a,{href:"https://protobuf.dev/reference/protobuf/google.protobuf/#empty",children:"google.protobuf.Empty"})," type. This modifies the signature of the Activity method to accept a single argument of type ",(0,r.jsx)(t.code,{children:"context.Context"})," and return a single value of type ",(0,r.jsx)(t.code,{children:"error"}),". Note that this also requires an additional ",(0,r.jsx)(t.code,{children:"google/protobuf/empty.proto"})," protobuf import statement."]}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-protobuf",metastring:'title="example.proto"',children:'syntax="proto3";\n\npackage example.v1;\n\nimport "google/protobuf/empty.proto";\nimport "temporal/v1/temporal.proto";\n\nservice Example {\n  // Hello returns a friendly greeting\n  rpc Hello(google.protobuf.Empty) returns (google.protobuf.Empty) {\n    option (temporal.v1.activity) = {\n      start_to_close_timeout: { seconds: 60 }\n    };\n  }\n}\n'})}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "context"\n\n    examplev1 "path/to/gen/example/v1"\n)\n\ntype Activities struct {}\n\nfunc (a *Activities) Hello(ctx context.Context) error {\n    return nil\n}\n'})})]})]}),"\n",(0,r.jsx)(t.h2,{id:"registration",children:"Registration"}),"\n",(0,r.jsx)(t.p,{children:"This plugin generates helpers for registering your activities with a Temporal worker."}),"\n",(0,r.jsxs)(a.A,{children:[(0,r.jsx)(i.A,{value:"registration-go",label:"Go",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",metastring:'title="main.go"',children:'package main\n\nimport (\n    "context"\n\n    examplev1 "path/to/gen/example/v1"\n    "go.temporal.io/sdk/client"\n    "go.temporal.io/sdk/worker"\n)\n\ntype Activities struct {}\n\nfunc (a *Activities) Hello(ctx context.Context, input *examplev1.HelloInput) (*examplev1.HelloOutput, error) {\n    return &examplev1.HelloOutput{}, nil\n}\n\nfunc main() {\n    // initialize temporal client and worker\n    c, err := client.Dial(client.Options{})\n    if err != nil {\n        log.Fatalf("error initializing client: %v", err)\n    }\n    w := worker.New(c, examplev1.ExampleTaskQueue, worker.Options{})\n\n    // Register all example.v1.Example activities with the worker\n    examplev1.RegisterExampleActivities(w, &Activities{})\n    w.Run(worker.InterruptCh())\n}\n'})})}),(0,r.jsx)(i.A,{value:"registration-schema",label:"Schema",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-protobuf",metastring:'title="example.proto"',children:'syntax="proto3";\n\npackage example.v1;\n\nimport "temporal/v1/temporal.proto";\n\nservice Example {\n  option (temporal.v1.service) = {\n    task_queue: "example-v1"\n  };\n\n  // Hello returns a friendly greeting\n  rpc Hello(HelloInput) returns (HelloOutput) {\n    option (temporal.v1.activity) = {\n      start_to_close_timeout: { seconds: 60 }\n    };\n  }\n}\n'})})})]})]})}function d(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(m,{...e})}):m(e)}},9365:(e,t,n)=>{n.d(t,{A:()=>i});n(6540);var r=n(4164);const o={tabItem:"tabItem_Ymn6"};var a=n(4848);function i(e){let{children:t,hidden:n,className:i}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.A)(o.tabItem,i),hidden:n,children:t})}},1470:(e,t,n)=>{n.d(t,{A:()=>A});var r=n(6540),o=n(4164),a=n(3104),i=n(6347),l=n(205),s=n(7485),u=n(1682),c=n(9466);function p(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function m(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return p(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:o}}=e;return{value:t,label:n,attributes:r,default:o}}))}(n);return function(e){const t=(0,u.X)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function d(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function g(e){let{queryString:t=!1,groupId:n}=e;const o=(0,i.W6)(),a=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,s.aZ)(a),(0,r.useCallback)((e=>{if(!a)return;const t=new URLSearchParams(o.location.search);t.set(a,e),o.replace({...o.location,search:t.toString()})}),[a,o])]}function h(e){const{defaultValue:t,queryString:n=!1,groupId:o}=e,a=m(e),[i,s]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!d({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:a}))),[u,p]=g({queryString:n,groupId:o}),[h,v]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[o,a]=(0,c.Dv)(n);return[o,(0,r.useCallback)((e=>{n&&a.set(e)}),[n,a])]}({groupId:o}),x=(()=>{const e=u??h;return d({value:e,tabValues:a})?e:null})();(0,l.A)((()=>{x&&s(x)}),[x]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!d({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);s(e),p(e),v(e)}),[p,v,a]),tabValues:a}}var v=n(2303);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=n(4848);function b(e){let{className:t,block:n,selectedValue:r,selectValue:i,tabValues:l}=e;const s=[],{blockElementScrollPositionUntilNextRender:u}=(0,a.a_)(),c=e=>{const t=e.currentTarget,n=s.indexOf(t),o=l[n].value;o!==r&&(u(t),i(o))},p=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=s.indexOf(e.currentTarget)+1;t=s[n]??s[0];break}case"ArrowLeft":{const n=s.indexOf(e.currentTarget)-1;t=s[n]??s[s.length-1];break}}t?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":n},t),children:l.map((e=>{let{value:t,label:n,attributes:a}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>s.push(e),onKeyDown:p,onClick:c,...a,className:(0,o.A)("tabs__item",x.tabItem,a?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function y(e){let{lazy:t,children:n,selectedValue:o}=e;const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=a.find((e=>e.props.value===o));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:a.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==o})))})}function j(e){const t=h(e);return(0,f.jsxs)("div",{className:(0,o.A)("tabs-container",x.tabList),children:[(0,f.jsx)(b,{...e,...t}),(0,f.jsx)(y,{...e,...t})]})}function A(e){const t=(0,v.A)();return(0,f.jsx)(j,{...e,children:p(e.children)},String(t))}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>l});var r=n(6540);const o={},a=r.createContext(o);function i(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);